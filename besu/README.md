# Besu Node Docker Application

This Docker application sets up a Hyperledger Besu node for blockchain networks. It uses Besu version 24.9.1 and provides a flexible configuration through environment variables and volume mounts.

## Prerequisites

- Docker
- Docker Compose

## Configuration

The application can be configured using the following environment variables in the `.env` file:

- `BESU_DATA_FOLDER`: Path to the node's data directory
- `BESU_KEY_FOLDER`: Path to `.key` folder generated by `utils\eth_account_creator`
- `BESU_GENESIS_FOLDER`: Path to `genesis.json` folder generated by `utils\qbft_genesis_creator`
- `BESU_BOOTNODES_FOLDER`: Path to `bootnodes.txt` folder generated by `utils\qbft_genesis_creator`
- `BESU_BOOTNODES`: Comma-separated list of bootnodes with their corresponding IPs
- `BESU_RPC_NETWORK`: IP address of node
- `BESU_RPC_PORT`: RPC Port of node

## BESU_BOOTNODES Format

The BESU_BOOTNODES environment variable specifies a comma-separated list of bootnode URLs. The format for each bootnode entry is:

```
<node_name>@<ip_address>:<port>
```

Where:
- `<node_name>` is the node name used in `bootnodes.txt`
- `<ip_address>` is the IP address of the node
- `<port>` is the P2P discovery port (usually 30303)

## Managing Port Binding with BESU_RPC_NETWORK and BESU_RPC_PORT

BESU_RPC_NETWORK and BESU_RPC_PORT can be used together to control how Besu node binds its RPC port:

### BESU_RPC_NETWORK

This variable specifies the network interface to which the RPC server should bind.

### BESU_RPC_PORT

This variable sets the port number for the RPC server.

### Usage Examples

1. Bind to localhost on port 8545:
   ```
   BESU_RPC_NETWORK=127.0.0.1
   BESU_RPC_PORT=8545
   ```

2. Bind to all interfaces on port 8888:
   ```
   BESU_RPC_NETWORK=0.0.0.0
   BESU_RPC_PORT=8888
   ```

3. Bind to a specific network interface on port 9000:
   ```
   BESU_RPC_NETWORK=192.168.1.5
   BESU_RPC_PORT=9000
   ```

## Usage

1. Set up your environment variables in the `.env` file.

2. Start the Besu node:

   ```bash
   docker-compose up
   ```


## Entrypoint Script

The `entrypoint.sh` script handles the following tasks:

- Processes the `BOOTNODES` environment variable
- Updates bootnode entries with corresponding IPs
- Starts the Besu node with the appropriate configuration

## Besu Configuration

The Besu node is configured with the following settings:

- Data path: `/sources/data`
- Genesis file: `/sources/network/genesis.json`
- Private key file: `/sources/account/.prv`
- Minimum gas price: 0
- P2P enabled on port 30303
- RPC HTTP enabled on port 8545
- RPC HTTP APIs: ETH, NET, QBFT
- CORS origins: all
- Host allowlist: all
